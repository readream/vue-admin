(window["webpackJsonp"]=window["webpackJsonp"]||[]).push([["chunk-12c80a52"],{b843:function(e,t,a){"use strict";a.r(t);var i=function(){var e=this,t=e.$createElement,a=e._self._c||t;return a("div",{staticClass:"user"},[a("el-row",[a("el-col",{attrs:{span:24}},[a("el-breadcrumb",{attrs:{separator:"/"}},[a("el-breadcrumb-item",{attrs:{to:{path:"/index"}}},[e._v("首页")]),a("el-breadcrumb-item",{attrs:{to:{path:"/index/user"}}},[e._v("用户管理")]),a("el-breadcrumb-item",{attrs:{to:{path:"/index/users"}}},[e._v("用户列表")])],1)],1)],1),a("el-row",[a("el-col",{attrs:{span:24}},[a("el-input",{staticClass:"user-input",attrs:{placeholder:"请输入内容"},nativeOn:{keydown:function(t){return!t.type.indexOf("key")&&e._k(t.keyCode,"enter",13,t.key,"Enter")?null:e.initData(t)}},model:{value:e.query,callback:function(t){e.query=t},expression:"query"}},[a("el-button",{attrs:{slot:"append",icon:"el-icon-search"},on:{click:e.initData},slot:"append"})],1),a("el-button",{attrs:{type:"success",plain:""},on:{click:function(t){e.addDialogFormVisible=!0}}},[e._v("添加用户")])],1)],1),a("el-table",{directives:[{name:"loading",rawName:"v-loading",value:e.loading,expression:"loading"}],staticStyle:{width:"100%"},attrs:{data:e.tableData,border:""}},[a("el-table-column",{attrs:{type:"index",width:"50"}}),a("el-table-column",{attrs:{prop:"username",label:"用户名",width:"180"}}),a("el-table-column",{attrs:{prop:"email",label:"邮箱",width:"180"}}),a("el-table-column",{attrs:{prop:"mobile",label:"手机号",width:"180"}}),a("el-table-column",{attrs:{prop:"role_name",label:"角色"}}),a("el-table-column",{attrs:{label:"用户状态",width:"100",align:"center"},scopedSlots:e._u([{key:"default",fn:function(t){return[a("el-switch",{on:{change:function(a){return e.changeState(t.row)}},model:{value:t.row.mg_state,callback:function(a){e.$set(t.row,"mg_state",a)},expression:"scope.row.mg_state"}})]}}])}),a("el-table-column",{attrs:{label:"操作",align:"center"},scopedSlots:e._u([{key:"default",fn:function(t){return[a("el-button",{attrs:{disabled:"admin"==t.row.username,size:"mini",type:"primary",icon:"el-icon-edit",plain:""},on:{click:function(a){return e.editUser(t.row)}}}),a("el-button",{attrs:{size:"mini",type:"danger",icon:"el-icon-delete",plain:""},on:{click:function(a){return e.deleteUser(t.row)}}}),a("el-button",{attrs:{size:"mini",type:"success",icon:"el-icon-check",plain:"",disabled:"admin"==t.row.username},on:{click:function(a){return e.getGrant(t.row)}}})]}}])})],1),a("el-pagination",{attrs:{"current-page":e.pagenum,"page-sizes":[5,10,15,20],"page-size":e.pagesize,layout:"total, sizes, prev, pager, next, jumper",total:e.total},on:{"size-change":e.handleSizeChange,"current-change":e.handleCurrentChange}}),a("el-dialog",{attrs:{title:"添加用户",visible:e.addDialogFormVisible},on:{"update:visible":function(t){e.addDialogFormVisible=t}}},[a("el-form",{ref:"ruleForm",attrs:{model:e.addForm,"label-width":"80px",rules:e.rules}},[a("el-form-item",{attrs:{label:"用户名",prop:"username"}},[a("el-input",{model:{value:e.addForm.username,callback:function(t){e.$set(e.addForm,"username",t)},expression:"addForm.username"}})],1),a("el-form-item",{attrs:{label:"密码",prop:"password"}},[a("el-input",{attrs:{type:"password"},model:{value:e.addForm.password,callback:function(t){e.$set(e.addForm,"password",t)},expression:"addForm.password"}})],1),a("el-form-item",{attrs:{label:"邮箱",prop:"email"}},[a("el-input",{model:{value:e.addForm.email,callback:function(t){e.$set(e.addForm,"email",t)},expression:"addForm.email"}})],1),a("el-form-item",{attrs:{label:"手机",prop:"mobile"}},[a("el-input",{model:{value:e.addForm.mobile,callback:function(t){e.$set(e.addForm,"mobile",t)},expression:"addForm.mobile"}})],1)],1),a("div",{staticClass:"dialog-footer",attrs:{slot:"footer"},slot:"footer"},[a("el-button",{on:{click:function(t){e.addDialogFormVisible=!1}}},[e._v("取 消")]),a("el-button",{attrs:{type:"primary"},on:{click:function(t){return e.addUser("ruleForm")}}},[e._v("确 定")])],1)],1),a("el-dialog",{attrs:{title:"编辑用户",visible:e.editDialogFormVisible},on:{"update:visible":function(t){e.editDialogFormVisible=t}}},[a("el-form",{ref:"ruleForm",attrs:{model:e.editForm,"label-width":"80px",rules:e.rules}},[a("el-form-item",{attrs:{label:"用户名",prop:"username"}},[a("el-input",{attrs:{disabled:!0},model:{value:e.editForm.username,callback:function(t){e.$set(e.editForm,"username",t)},expression:"editForm.username"}})],1),a("el-form-item",{attrs:{label:"邮箱",prop:"email"}},[a("el-input",{model:{value:e.editForm.email,callback:function(t){e.$set(e.editForm,"email",t)},expression:"editForm.email"}})],1),a("el-form-item",{attrs:{label:"手机",prop:"mobile"}},[a("el-input",{model:{value:e.editForm.mobile,callback:function(t){e.$set(e.editForm,"mobile",t)},expression:"editForm.mobile"}})],1)],1),a("div",{staticClass:"dialog-footer",attrs:{slot:"footer"},slot:"footer"},[a("el-button",{on:{click:function(t){e.editDialogFormVisible=!1}}},[e._v("取 消")]),a("el-button",{attrs:{type:"primary"},on:{click:function(t){return e.updateUser("ruleForm")}}},[e._v("确 定")])],1)],1),a("el-dialog",{attrs:{title:"角色分配",visible:e.grantDialogFormVisible},on:{"update:visible":function(t){e.grantDialogFormVisible=t}}},[a("el-form",{ref:"ruleForm",attrs:{model:e.grantForm,"label-width":"80px",rules:e.rules}},[a("el-form-item",{attrs:{label:"用户名",prop:"username"}},[a("el-tag",{attrs:{type:"success"}},[e._v(e._s(e.grantForm.username))])],1),a("el-form-item",{attrs:{label:"角色分配"}},[a("el-select",{attrs:{placeholder:"请选择角色"},model:{value:e.itemId,callback:function(t){e.itemId=t},expression:"itemId"}},e._l(e.grantList,function(e,t){return a("el-option",{key:t,attrs:{label:e.roleName,value:e.id}})}),1)],1),e._v("\n      "+e._s(e.itemId)+"\n    ")],1),a("div",{staticClass:"dialog-footer",attrs:{slot:"footer"},slot:"footer"},[a("el-button",{on:{click:function(t){e.grantDialogFormVisible=!1}}},[e._v("取 消")]),a("el-button",{attrs:{type:"primary"},on:{click:e.confirmGrant}},[e._v("确 定")])],1)],1)],1)},r=[],s=a("365c"),o={data:function(){return{tableData:[],loading:!0,query:"",total:0,pagesize:5,pagenum:1,addDialogFormVisible:!1,editDialogFormVisible:!1,grantDialogFormVisible:!1,addForm:{username:"",password:"",email:"",mobile:""},editForm:{username:"",email:"",mobile:"",id:""},grantForm:{username:""},grantList:[],itemId:"",rules:{username:[{required:!0,message:"请输入用户名",trigger:"blur"}],password:[{required:!0,message:"请输入密码",trigger:"blur"}],email:[{required:!0,message:"请输入邮箱地址",trigger:"blur"},{type:"email",message:"请输入正确的邮箱地址",trigger:["blur","change"]}],mobile:[{required:!0,message:"请输入手机号",trigger:"blur"}]}}},created:function(){this.initData()},methods:{handleSizeChange:function(e){console.log(e),this.pagesize=e,this.initData()},handleCurrentChange:function(e){this.pagenum=e,this.initData()},initData:function(){var e=this;Object(s["p"])({params:{query:this.query,pagenum:this.pagenum,pagesize:this.pagesize}}).then(function(t){e.tableData=t.data.users,e.total=t.data.total,e.loading=!1})},changeState:function(e){var t=this;Object(s["c"])({uId:e.id,type:e.mg_state}).then(function(e){200===e.meta.status?t.$message({message:"恭喜你，修改成功",type:"success"}):t.$message({message:e.meta.msg,type:"warning"})})},addUser:function(e){var t=this;this.$refs[e].validate(function(e){e?Object(s["b"])(t.addForm).then(function(e){201===e.meta.status?(t.$message({message:"添加用户成功",type:"success"}),t.addDialogFormVisible=!1,t.initData()):t.$message({message:"添加用户失败",type:"danger"})}):console.log("error")})},editUser:function(e){var t=this;Object(s["t"])(e.id).then(function(e){200===e.meta.status&&(t.editForm.username=e.data.username,t.editForm.email=e.data.email,t.editForm.mobile=e.data.mobile,t.editForm.id=e.data.id),t.editDialogFormVisible=!0})},updateUser:function(e){var t=this;this.$refs[e].validate(function(e){e?Object(s["v"])(t.editForm).then(function(e){200===e.meta.status?(t.$message({type:"success",message:"修改成功"}),t.editDialogFormVisible=!1,t.initData()):t.$message({type:"danger",message:"修改失败"})}):console.log("err")})},deleteUser:function(e){var t=this;this.$confirm("此操作将永久删除该用户, 是否继续?","提示",{confirmButtonText:"确定",cancelButtonText:"取消",type:"warning"}).then(function(){Object(s["h"])(e.id).then(function(e){200===e.meta.status&&(t.$message({type:"success",message:"删除成功!"}),t.initData())})}).catch(function(){t.$message({type:"info",message:"已取消删除"})})},getGrant:function(e){var t=this;this.grantDialogFormVisible=!0,this.grantForm=e,console.log(e),Object(s["l"])().then(function(e){console.log(e),200===e.meta.status&&(t.grantList=e.data)})},confirmGrant:function(){var e=this;console.log(this.grantForm.id,this.itemId),this.itemId?(Object(s["q"])({id:this.grantForm.id,rid:this.itemId}).then(function(t){200===t.meta.status?(e.$message({type:"success",message:"分配角色成功"}),e.initData()):e.$message({type:"danger",message:"分配角色失败"})}),this.grantDialogFormVisible=!1):this.$message({type:"danger",message:"请分配角色"})}}},l=o,n=(a("e146"),a("2877")),m=Object(n["a"])(l,i,r,!1,null,"806afae6",null);t["default"]=m.exports},c8fb:function(e,t,a){},e146:function(e,t,a){"use strict";var i=a("c8fb"),r=a.n(i);r.a}}]);
//# sourceMappingURL=chunk-12c80a52.857c5bc3.js.map