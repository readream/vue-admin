(window["webpackJsonp"]=window["webpackJsonp"]||[]).push([["chunk-6c13f66e"],{"15a8":function(e,t,o){"use strict";o.r(t);var l=function(){var e=this,t=e.$createElement,o=e._self._c||t;return o("div",{staticClass:"roles"},[o("el-row",[o("el-col",{attrs:{span:24}},[o("el-breadcrumb",{attrs:{separator:"/"}},[o("el-breadcrumb-item",{attrs:{to:{path:"/index"}}},[e._v("首页")]),o("el-breadcrumb-item",{attrs:{to:{path:"/index/roles"}}},[e._v("权限管理")]),o("el-breadcrumb-item",{attrs:{to:{path:"/index/roles"}}},[e._v("角色列表")])],1)],1)],1),o("el-button",{attrs:{type:"primary",plain:""},on:{click:e.addRole}},[e._v("添加角色")]),[o("el-table",{staticStyle:{width:"100%"},attrs:{data:e.roleList,border:""}},[o("el-table-column",{attrs:{type:"expand"},scopedSlots:e._u([{key:"default",fn:function(t){return e._l(t.row.children,function(l){return o("el-row",{key:l.id},[o("el-col",{attrs:{span:4}},[o("el-tag",{attrs:{closable:""},on:{close:function(o){return e.deleteRole(t.row,l.id)}}},[e._v(e._s(l.authName))]),0!=t.row.children.length?o("i",{staticClass:"el-icon-arrow-right"}):e._e()],1),o("el-col",{attrs:{span:20}},e._l(l.children,function(l){return o("el-row",{key:l.id},[o("el-col",{attrs:{span:4}},[o("el-tag",{attrs:{closable:"",type:"success"},on:{close:function(o){return e.deleteRole(t.row,l.id)}}},[e._v(e._s(l.authName))]),0!=t.row.children.length?o("i",{staticClass:"el-icon-arrow-right"}):e._e()],1),o("el-col",{attrs:{span:20}},e._l(l.children,function(l){return o("el-tag",{key:l.id,attrs:{closable:"",type:"danger"},on:{close:function(o){return e.deleteRole(t.row,l.id)}}},[e._v(e._s(l.authName))])}),1)],1)}),1)],1)})}}])}),o("el-table-column",{attrs:{type:"index",width:"50"}}),o("el-table-column",{attrs:{label:"角色",prop:"roleName",width:"120px"}}),o("el-table-column",{attrs:{label:"描述",prop:"roleDesc",width:"120px"}}),o("el-table-column",{attrs:{label:"操作",align:"center"},scopedSlots:e._u([{key:"default",fn:function(t){return[o("el-button",{attrs:{disabled:"admin"==t.row.username,size:"mini",type:"primary",icon:"el-icon-edit",plain:"",title:"编辑角色"},on:{click:function(o){return e.eidRole(t.row)}}}),o("el-button",{attrs:{disabled:"admin"==t.row.username,size:"mini",type:"danger",icon:"el-icon-delete",plain:"",title:"删除角色"},on:{click:function(o){return e.deleteRoleById(t.row)}}}),o("el-button",{attrs:{size:"mini",type:"success",icon:"el-icon-check",plain:"",title:"编辑权限",disabled:"admin"==t.row.username},on:{click:function(o){return e.confirmRight(t.row)}}})]}}])})],1)],o("el-dialog",{attrs:{title:"编辑权限",visible:e.grantDialogFormVisible},on:{"update:visible":function(t){e.grantDialogFormVisible=t}}},[o("div",{staticClass:"row-tree"},[o("el-tree",{ref:"tree",attrs:{data:e.rightList,"show-checkbox":"","node-key":"id","default-expand-all":!0,"default-checked-keys":e.selectedRightId,props:e.defaultProps}})],1),o("div",{staticClass:"dialog-footer",attrs:{slot:"footer"},slot:"footer"},[o("el-button",{on:{click:function(t){e.grantDialogFormVisible=!1}}},[e._v("取 消")]),o("el-button",{attrs:{type:"primary"},on:{click:function(t){return e.roleRight()}}},[e._v("确 定")])],1)]),o("el-dialog",{attrs:{title:"添加角色",visible:e.addDialogFormVisible},on:{"update:visible":function(t){e.addDialogFormVisible=t}}},[o("el-form",{ref:"roleForm",attrs:{model:e.roleForm,rules:e.rules,"label-width":"80px"}},[o("el-form-item",{attrs:{label:"角色",prop:"roleName"}},[o("el-input",{attrs:{autocomplete:"off"},model:{value:e.roleForm.roleName,callback:function(t){e.$set(e.roleForm,"roleName",t)},expression:"roleForm.roleName"}})],1),o("el-form-item",{attrs:{label:"描述",prop:"roleDesc"}},[o("el-input",{attrs:{autocomplete:"off"},model:{value:e.roleForm.roleDesc,callback:function(t){e.$set(e.roleForm,"roleDesc",t)},expression:"roleForm.roleDesc"}})],1)],1),o("div",{staticClass:"dialog-footer",attrs:{slot:"footer"},slot:"footer"},[o("el-button",{on:{click:function(t){e.addDialogFormVisible=!1}}},[e._v("取 消")]),o("el-button",{attrs:{type:"primary"},on:{click:function(t){return e.addRoleName("roleForm")}}},[e._v("确 定")])],1)],1),o("el-dialog",{attrs:{title:"编辑角色",visible:e.editDialogFormVisible},on:{"update:visible":function(t){e.editDialogFormVisible=t}}},[o("el-form",{ref:"editroleForm",attrs:{model:e.editroleForm,rules:e.rules,"label-width":"80px"}},[o("el-form-item",{attrs:{label:"角色",prop:"roleName"}},[o("el-input",{attrs:{autocomplete:"off"},model:{value:e.editroleForm.roleName,callback:function(t){e.$set(e.editroleForm,"roleName",t)},expression:"editroleForm.roleName"}})],1),o("el-form-item",{attrs:{label:"描述",prop:"roleDesc"}},[o("el-input",{attrs:{autocomplete:"off"},model:{value:e.editroleForm.roleDesc,callback:function(t){e.$set(e.editroleForm,"roleDesc",t)},expression:"editroleForm.roleDesc"}})],1)],1),o("div",{staticClass:"dialog-footer",attrs:{slot:"footer"},slot:"footer"},[o("el-button",{on:{click:function(t){e.editDialogFormVisible=!1}}},[e._v("取 消")]),o("el-button",{attrs:{type:"primary"},on:{click:function(t){return e.eidRoleName("editroleForm")}}},[e._v("确 定")])],1)],1)],2)},i=[],r=(o("ac6a"),o("365c")),a={data:function(){return{roleList:[],loading:!0,rightList:[],addDialogFormVisible:!1,editDialogFormVisible:!1,grantDialogFormVisible:!1,seletedRoel:{},selectedRightId:[],defaultProps:{children:"children",label:"authName"},roleForm:{},editroleForm:{},rules:{roleName:[{required:!0,message:"请输入角色名字",trigger:"blur"}],roleDesc:[{required:!0,message:"请输入描述文字",trigger:"blur"}]}}},created:function(){this.initRoleData()},methods:{initRoleData:function(){var e=this;Object(r["l"])().then(function(t){200===t.meta.status&&(e.roleList=t.data,console.log(e.roleList))})},deleteRole:function(e,t){var o=this;console.log(e),Object(r["g"])({roleId:e.id,rightId:t}).then(function(t){200===t.meta.status?(e.children=t.data,o.$message({type:"success",message:"取消权限成功"})):o.$message({type:"danger",message:"取消权限失败"})})},confirmRight:function(e){var t=this;console.log(e),this.seletedRoel=e,Object(r["o"])({type:"tree"}).then(function(e){t.grantDialogFormVisible=!0,200===e.meta.status?(t.rightList=e.data,console.log(t.rightList)):t.$message({type:"danger",message:"数据获取失败"}),t.selectedRightId=[],t.seletedRoel.children.forEach(function(e){e.children&&0!==e.children.lenght&&e.children.forEach(function(e){t.selectedRightId.push(e.id)})})})},roleRight:function(){var e=this,t=this.$refs.tree.getCheckedKeys().join(",");Object(r["u"])(this.seletedRoel.id,{rids:t}).then(function(t){200===t.meta.status?e.$message({tyep:"success",message:"权限分配成功"}):e.$message({type:"danger",message:"权限分配失败"}),e.grantDialogFormVisible=!1,e.initRoleData()})},addRole:function(){this.addDialogFormVisible=!0},addRoleName:function(e){var t=this;this.$refs[e].validate(function(e){e?(console.log(t.roleForm),Object(r["a"])({roleName:t.roleForm.roleName,roleDesc:t.roleForm.roleDesc}).then(function(e){console.log(e),201===e.meta.status?(t.$message({type:"success",message:"创建成功"}),t.addDialogFormVisible=!1,t.initRoleData()):t.$message({type:"danger",message:"创建失败"})})):console.log("err")})},deleteRoleById:function(e){var t=this;this.$confirm("此操将永久删除该角色, 是否继续?","提示",{confirmButtonText:"确定",cancelButtonText:"取消",type:"warning"}).then(function(){Object(r["f"])({id:e.id}).then(function(e){200===e.meta.status?(t.$message({type:"success",message:"删除成功!"}),t.initRoleData()):t.$message({type:"danger",message:"删除失败!"})})}).catch(function(){t.$message({type:"info",message:"已取消删除"})})},eidRole:function(e){var t=this;Object(r["s"])({id:e.id}).then(function(e){200===e.meta.status?(t.editroleForm=e.data,t.editDialogFormVisible=!0):t.$message({type:"danger",message:"数据获取失败，请联系管理员"})})},eidRoleName:function(e){var t=this;this.$refs[e].validate(function(e){e&&Object(r["j"])({id:t.editroleForm.roleId,roleName:t.editroleForm.roleName,roleDesc:t.editroleForm.roleDesc}).then(function(e){200===e.meta.status?(t.$message({type:"success",message:"信息编辑成功"}),t.initRoleData(),t.editDialogFormVisible=!1,console.log(e)):t.$message({type:"danger",message:"信息编辑失败"})})})}}},s=a,n=(o("988c"),o("2877")),c=Object(n["a"])(s,l,i,!1,null,"ef99ebbe",null);t["default"]=c.exports},"988c":function(e,t,o){"use strict";var l=o("9a9e"),i=o.n(l);i.a},"9a9e":function(e,t,o){},ac6a:function(e,t,o){for(var l=o("cadf"),i=o("0d58"),r=o("2aba"),a=o("7726"),s=o("32e9"),n=o("84f2"),c=o("2b4c"),d=c("iterator"),u=c("toStringTag"),m=n.Array,g={CSSRuleList:!0,CSSStyleDeclaration:!1,CSSValueList:!1,ClientRectList:!1,DOMRectList:!1,DOMStringList:!1,DOMTokenList:!0,DataTransferItemList:!1,FileList:!1,HTMLAllCollection:!1,HTMLCollection:!1,HTMLFormElement:!1,HTMLSelectElement:!1,MediaList:!0,MimeTypeArray:!1,NamedNodeMap:!1,NodeList:!0,PaintRequestList:!1,Plugin:!1,PluginArray:!1,SVGLengthList:!1,SVGNumberList:!1,SVGPathSegList:!1,SVGPointList:!1,SVGStringList:!1,SVGTransformList:!1,SourceBufferList:!1,StyleSheetList:!0,TextTrackCueList:!1,TextTrackList:!1,TouchList:!1},f=i(g),p=0;p<f.length;p++){var b,h=f[p],y=g[h],F=a[h],v=F&&F.prototype;if(v&&(v[d]||s(v,d,m),v[u]||s(v,u,h),n[h]=m,y))for(b in l)v[b]||r(v,b,l[b],!0)}}}]);
//# sourceMappingURL=chunk-6c13f66e.0fa25d61.js.map